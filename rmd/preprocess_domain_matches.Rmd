---
title: "Analysis of domains in alternative TF isoforms"
author: "Sviatoslav Sidorov"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    collapsed: no
    fig_align: center
    fig_caption: yes
    highlight: haddock
    keep_md: yes
    number_sections: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r, include=T}
stringsAsFactors = F
library(tidyverse)
library(kableExtra)
library(yaml)
library(data.tree)
library(XLConnect)
library(R.utils)
```

# Print package versions

Print versions of the loaded libraries:

```{r, include=T}
packageVersion("tidyverse")
packageVersion("kableExtra")
packageVersion("yaml")
packageVersion("data.tree")
packageVersion("XLConnect")
packageVersion("R.utils")
```

# Read input

Read args:

```{r, include=T}
args = commandArgs()

interpro_entries_name = args[9]
ips_domains_ipr_ens99 = args[10]
ipr_hierarchy_yaml_name = args[11]
humantfs_dbd_ids_name = args[12]
ips_domains_ipr_ens99_iprs_name = args[13]
dbd_ipr_humantfs_name = args[14]
ensg_enst_ensp_name = args[15]

#humantfs_name = args[9]
#ensembl99_all_name = args[11]
#gene_biotype_table_name = args[12]
#protein_fasta_tfs_name = args[13]
#draft_classification_table_name = args[15]
#domain_classification_wb_name = args[16]
#ensg_enst_tsl_name = args[17]
#ens99_pep_name = args[18]
#nondbd.annot_name = args[19]
```

# Prepare for the filtering of matches in TF protein products from Ensembl v99

InterPro has entries of 5 different types (information on each type is taken from [InterPro entry types](https://www.ebi.ac.uk/training/online/course/interpro-functional-and-structural-analysis-protei/what-interpro-entry/interpro-entry-types)):

* __Homologous Superfamily__ usually include proteins with a certain tertiary structure. Homologous Superfamilies are always composed of CATH-Gene3D and/or SUPERFAMILY signatures. Homologous Superfamily entries do not form hierarchies.

* __Protein Family__ contains proteins with a common ancestor. Families are organized in hierarchies.

* __Domain__ is a separable structural or functional part of a protein. They can form hierarchies.

* __Site__ is a small locus in a protein (typically, only several residues long) that may affect the protein's function. Sites do not form hierarchies. InterPro includes the following types of Sites:

    - __active sites__ contain residues with catalytic activity;

    - __binding sites__ contain residues that bind molecules or ions;
  
    - __post-translation modification (PTM) sites__ contain residues that can be chemically modified after translation;
  
    - __conserved sites__ are loci of an unknown function that are found in certain types of proteins.

* __Repeat__ is a short sequence repeated in a protein. It may facilitate binding or other characteristics. Repeats do not form hierarchies.

"Hierarchical relationships are identified between evolutionarily related InterPro entries, tracing those that represent smaller, functionally specific subfamilies of larger families, or subclasses of broader classes of domain" [Mitchell et al., 2018](https://academic.oup.com/nar/article/47/D1/D351/5162469).

Hence, we will need to hierarchically filter InterPro entries, prioritizing domains.

The numbers of matches (InterPro entries) of different types in TF protein isoforms:

```{r, include=T}
interpro_entries = read.delim(interpro_entries_name)
head(interpro_entries, 10)
class(interpro_entries)
```
